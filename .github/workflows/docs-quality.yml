name: docs-quality

on:
  pull_request:
  push:
    branches: [ main ]

permissions:
  contents: read

jobs:
  docs-quality:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1

      - name: Install tools
        shell: bash
        run: |
          set -euo pipefail
          python3 -m pip install --upgrade pip
          python3 -m pip install codespell

          npm install -g markdownlint-cli2

          # Vale (pin version; update intentionally)
          VALE_VERSION="3.11.0"
          curl -fsSL -o vale.tar.gz \
            "https://github.com/errata-ai/vale/releases/download/v${VALE_VERSION}/vale_${VALE_VERSION}_Linux_64-bit.tar.gz"
          tar -xzf vale.tar.gz vale
          sudo mv vale /usr/local/bin/vale
          vale --version

      - name: Codespell
        run: |
          codespell \
            --check-filenames \
            --check-hidden \
            --skip="*.lock,*.png,*.jpg,*.jpeg,*.gif,*.svg,*.pdf,node_modules,.git" \
            .

      - name: Markdownlint
        run: |
          markdownlint-cli2 "**/*.md" "#node_modules" "#.git"

      - name: Vale
        run: |
          # If you have a Vale config already, this will use it.
          # If not, add .vale.ini + styles (recommended).
          vale .
